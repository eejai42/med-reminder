@startuml
hide empty description

[*] --> Idle : Enter Idle\nRecord last_index

Idle : entry: last_index = getIndex()\nexit: Reset debounce timer
Idle --> Debouncing : getIndex() != last_index
Debouncing --> Idle : getIndex() == last_index
Debouncing --> Movement_Counting : Debounce Timeout\n&&\ngetIndex() stays
Movement_Counting : entry: movement_count++\nexit: Check for new movement
Movement_Counting --> Movement_Detected : No new movement\nwithin timeout
Movement_Detected --> Idle : clearMovement()

Movement_Counting --> Movement_Counting : New movement within timeout

@enduml
